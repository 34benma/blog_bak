---
title: 我想做一个后端服务器
date: 2016-12-09 19:50:45
tags: 
 - 服务器开发
 - Netty
categories: 软件开发
---

从上一家公司莫名其妙离职后(是的，对于不可言说的事情我都是用莫名其妙，乱七八糟这样的词汇形容~~~)进入新公司，主力还是做后端服务器API开发，这也是我一直感兴趣的方向。目前我们的技术框架主体是Tomcat+Spring+SpringMVC+Redis+MySQL。
估计，这也是大多数互联网公司所采用的技术框架。因为开源，好用~

这个技术框架和我上一家(上家技术就是*雷的技术)基本类似，不过服务器和技术架构还是差别挺大。两个关键区别是Netty框架VSTomcat容器，动静分离，前后端分离VS动静结合，前后端结合。结合我在新公司上手项目和上一家上手项目的速度以及软件架构设计和项目运维的实际情况，我萌发了想做一款后端服务器的想法。

<!--more-->

<h2>动静分离,前后端分离</h2>

动静分离指的是Web项目中动态资源和静态资源的分离。所谓动态资源我理解就是逻辑数据。比如说一个游戏排行榜，排行榜的数据是动态更新的，但是排行榜的样式是固定不变的。这些样式是由图片，HTML，JS，CSS等构成。而数据的产生就是服务器的逻辑代码经过逻辑运算最终产生。分离就是要分离这些东西。这里动态数据的产生就需要后端程序员来提供，而HTML，JS，CSS等各种样式，动态展现效果等的实现是前端工程师，重构工程师，UI设计师等共同实现。

因此动静分离带来的结果就是前后端分离。后端工程师只要懂后端，不需要调界面，写JS了。前端工程师只要做效果，和用户交互，不需要考虑数据的来源以及正确性了。

前后端交互则通过HTTP请求，数据表现形式通常是JSON。有的也用XML，但我觉得JSON性能和易用性上明显要高于XML。

<h2>Tomcat可以实现动静分离，前后端分离吗？</h2>

我觉得答案是可以，必须可以。Tomcat是一个非常优秀的Servlet容器。无论从设计上还是代码编写上(曾经深入读过Tomcat大部分源码)都是一个非常优秀的容器(其作者也是Struts的作者，因此设计思想上有些类似，但是Struts现在基本没人用了，Tomcat作为服务器还在被大量使用)。但是Tomcat也仅仅是个Servlet容器。它提供的组件式，可插入式的设计思想非常灵活。

但灵活带来的代价我认为是复杂性。Tomcat的配置还是比较麻烦的。默认的HTTP请求处理模式是BIO，如果使用NIO需要专门的配置。同时，随着项目的体积增大，启动Tomcat和调试程序都变成了一件非常复杂需要很多耐心的事情。因此，从项目入手和项目维护简易上来说，Tomcat做的比较糟糕。

<h2>一切回归main</h2>

main函数是一切程序启动的入口。因为Tomcat帮我们把main函数(在Tomcat的Bootstrap类里)写了。因此我们Web程序的代码实际上都是逻辑代码。一坨我们不需要写入口的代码。Tomcat为什么叫做容器？从这里也可以找到一点点依据。所有类的加载和执行我们都控制不了。如果一个程序需要我们手动来写main函数，给我们的感觉是我们在控制程序的入口，那么我们的逻辑代码就不再是被放到容器中来了。我们的项目也不在需要是一个标准的Java Web项目，而是一个标准的Java项目。因此，回归到main，将更加容易理解并调试项目。

<h2>NIO框架</h2>

NIO框架里两个非常优秀的框架是Netty和Mina。Mina暂时还没研究过。因为工作经历的关系，研究过Netty。Netty作为一个非常优秀的NIO框架让我们编写一个基于NIO的服务器变得非常简单。特别是Netty4在Netty3基础上对线程模型的改进。因此基于Netty4编写一个后端服务器，应该是有非常良好的IO处理性能和并发处理性能。

<h2>我为什么想做一个后端服务器？</h2>

因为种种乱七八糟的原因，上一家自研的服务器框架没有开源出来造福广大后端服务器程序员。因此有上一家公司的工作经历后，加上Tomcat和SpringMVC给程序员以及项目开发速度上带来的问题，我觉得做一个高性能，高可靠的易用的后端服务器是一件非常有意义的事情。基于我对Netty4和上家公司后端服务器框架的理解，加上我自己在项目开发和管理中遇到的一些痛点，我决定写一个后端服务器。

这个服务器原始的需求基本和上一家公司的很类似(不得不赞叹*雷技术实力和前瞻性，这款服务器开发于2010年，有些理念最近才逐渐火起来)。但是，我不会直接引用。最大的区别是Netty版本的区别。我将废弃Netty3，使用Netty4。

它要达到的目标是让动静分离变得极其简单，让后端程序员专注做后端，专注在高性能，可靠性，可拓展性等问题上，前端程序员专注在极好的用户体验和正确的用户数据上。

最重要的是，它要实现项目的极快速开发和高质量，高可靠性。软件开发相关专业的毕业生能够在一周内上手项目并且能写出高质量的逻辑代码。因为框架屏蔽了Spring,SpringMVC，Redis,MySQL等一些部署和使用细节。真正实现后端程序员只要关注BO和DAO，并且设计良好的数据模型即可。

这就是我想做的~目前已经有一个良好的开始。

我把项目名字取名Puppy。可爱的小狗的意思。感兴趣的同学可以<a href="mailto:wantedonline@outlook.com">联系我</a>，一起做这个还算有意义的事情。目前我正在做[V0.4.0](https://github.com/34benma/Puppy/blob/master/doc/puppy_plan)

项目地址: [https://github.com/34benma/Puppy](https://github.com/34benma/Puppy)

